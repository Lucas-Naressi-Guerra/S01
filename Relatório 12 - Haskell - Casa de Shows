-- Tipos de domínio
data Genero = Rock | Pop | Jazz | Eletronico | Sertanejo
  deriving (Show, Read, Eq)

data Banda = Banda
  { nomeBanda :: String
  , genero    :: Genero
  , cache     :: Double
  } deriving (Show)

data StatusEvento = Ativo | Encerrado | Cancelado
  deriving (Show, Read, Eq)

data Evento = Evento
  { bandas :: [Banda]
  , status :: StatusEvento
  } deriving (Show)

-- Função que calcula o custo total do evento
custoTotalEvento :: Evento -> Double
custoTotalEvento (Evento _ Cancelado) = 0.0
custoTotalEvento (Evento bs _) =
  let total = sum (map cache bs)
  in total * 1.20  -- adiciona 20% de taxa de produção

-- Função que retorna a banda de abertura
bandaAbertura :: Evento -> String
bandaAbertura (Evento [] _)     = "Nenhuma banda cadastrada para abertura."
bandaAbertura (Evento (b:_) _)  = nomeBanda b

-- Função que retorna a banda de encerramento
bandaEncerramento :: Evento -> String
bandaEncerramento (Evento [] _) = "Nenhuma banda cadastrada para encerramento."
bandaEncerramento (Evento bs _) = nomeBanda (last bs)

-- Função principal com 3 eventos
main :: IO ()
main = do
  let b1 = Banda "The Gorons" Rock 5000.0
  let b2 = Banda "Zelda & The Fairies" Pop 3000.0
  let b3 = Banda "Hyrule Jazz Band" Jazz 2500.0

  let evento1 = Evento [b1, b2, b3] Ativo
  let evento2 = Evento [b2, b3] Encerrado
  let evento3 = Evento [] Cancelado

  putStrLn " Evento 1 (Ativo):"
  print evento1
  putStrLn $ "Custo total: R$" ++ show (custoTotalEvento evento1)
  putStrLn $ "Banda de abertura: " ++ bandaAbertura evento1
  putStrLn $ "Banda de encerramento: " ++ bandaEncerramento evento1

  putStrLn "\n Evento 2 (Encerrado):"
  print evento2
  putStrLn $ "Custo total: R$" ++ show (custoTotalEvento evento2)
  putStrLn $ "Banda de abertura: " ++ bandaAbertura evento2
  putStrLn $ "Banda de encerramento: " ++ bandaEncerramento evento2

  putStrLn "\n Evento 3 (Cancelado):"
  print evento3
  putStrLn $ "Custo total: R$" ++ show (custoTotalEvento evento3)
  putStrLn $ "Banda de abertura: " ++ bandaAbertura evento3
  putStrLn $ "Banda de encerramento: " ++ bandaEncerramento evento3
